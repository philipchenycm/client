<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Service Evaluation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            padding: 15mm;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        
        /* Headers */
        h1 { color: #003366; border-bottom: 2px solid #003366; padding-bottom: 10px; margin-bottom: 20px; font-size: 24px; text-transform: uppercase; }
        h2 { background-color: #003366 !important; color: white !important; padding: 8px 10px; font-size: 16px; margin-top: 20px; -webkit-print-color-adjust: exact; }
        
        /* Inputs */
        input[type="text"], input[type="date"] {
            border: 1px solid #ccc; padding: 5px; width: 100%; box-sizing: border-box; font-family: inherit;
        }
        textarea { width: 100%; border: 1px solid #ccc; height: 60px; font-family: inherit; padding: 5px; box-sizing: border-box;}

        /* Rating Tables */
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; font-size: 13px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; vertical-align: middle; }
        th { background-color: #f8f9fa; font-weight: bold; width: 40%; }
        
        /* Radio Button Styling */
        .rating-container { display: flex; justify-content: space-between; padding: 0 10px; }
        .rating-label { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #555; cursor: pointer; }
        .rating-label input { margin-bottom: 3px; cursor: pointer; }

        /* Chart Section */
        .chart-container {
            width: 100%;
            height: 300px;
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border: 1px solid #eee;
            padding: 10px;
        }

        /* Average Score Display */
        .score-display { float: right; font-weight: bold; color: #003366; font-size: 14px; }

        .btn-print {
            position: fixed; top: 20px; right: 20px; padding: 10px 20px; 
            background: #007bff; color: white; border: none; cursor: pointer; 
            font-weight: bold; border-radius: 5px;
        }

        @media print {
            body { background: none; padding: 0; }
            .page { box-shadow: none; margin: 0; width: 100%; }
            .btn-print { display: none; }
            input, textarea { border: none; border-bottom: 1px solid #ccc; }
        }
    </style>
</head>
<body>
    <button class="btn-print" onclick="window.print()">Print / Save PDF</button>

    <div class="page">
        <h1>Customer Service Evaluation</h1>
        <h1>顾客满意度调查</h1>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <div><label>Client Company(工厂名字):</label><input type="text"></div>
            <div><label>Evaluator Name(撰写人):</label><input type="text"></div>
             <div><label>YCM Representative(YCM代表):</label><input type="text" value="Bee Istarapon" readonly></div>
            <div><label>Date(日期):</label><input type="date"></div>
        </div>

        <p style="font-size: 12px; color: #666; font-style: italic;">
            Please rate the following categories on a scale of 1 to 5, where <strong>1 = Poor</strong> and <strong>5 = Excellent</strong>.
            请评判一下几个问题 <strong>1 = 差</strong> and <strong>5 = 很棒</strong>.
        </p>

        <h2>1. YCM Service Quality(服务质量) <span class="score-display">Avg: <span id="s1_avg">0.0</span></span></h2>
        <table>
            <tr><th>Responsiveness to Requests(响应速度)</th><td><div class="rating-container" id="s1_q1"></div></td></tr>
            <tr><th>Problem Solving Ability(解决问题能力)</th><td><div class="rating-container" id="s1_q2"></div></td></tr>
            <tr><th>Professionalism & Communication(专业度)</th><td><div class="rating-container" id="s1_q3"></div></td></tr>
        </table>
        <textarea placeholder="Comments on Service Quality(请评价一下我们的服务质量)..."></textarea>

        <h2>2. Interpreter Performance(翻译的质量) <span class="score-display">Avg: <span id="s2_avg">0.0</span></span></h2>
        <table>
            <tr><th>Language Proficiency(准确度)</th><td><div class="rating-container" id="s2_q1"></div></td></tr>
            <tr><th>Availability & Punctuality(准时性)</th><td><div class="rating-container" id="s2_q2"></div></td></tr>
            <tr><th>Attitude & Cooperation(态度)</th><td><div class="rating-container" id="s2_q3"></div></td></tr>
        </table>
        <textarea placeholder="Comments on Interpreter(请评价一下我们的翻译)..."></textarea>

        <h2>3. Workforce Quality(工人质量) <span class="score-display">Avg: <span id="s3_avg">0.0</span></span></h2>
        <table>
            <tr><th>Attendance & Discipline(考勤&纪律性)</th><td><div class="rating-container" id="s3_q1"></div></td></tr>
            <tr><th>Skill & Productivity(生产力&技能)</th><td><div class="rating-container" id="s3_q2"></div></td></tr>
            <tr><th>Compliance (Rules/Safety)(遵守条例)</th><td><div class="rating-container" id="s3_q3"></div></td></tr>
        </table>
        <textarea placeholder="Comments on Workforce(请评价一下我们的工人)..."></textarea>

        <h2>4. Other Issues / General Feedback(额外的评价)</h2>
        <label style="font-size:12px; font-weight:bold;">Please describe any specific issues or suggestions(请提供其他的问题或评价):</label>
        <textarea style="height: 100px; margin-top:5px;"></textarea>

        <div style="margin-top: 30px;">
            <div style="text-align: center; font-weight: bold; color: #333; margin-bottom: 10px;">Performance Overview(效果总览)</div>
            <div class="chart-container">
                <canvas id="radarChart"></canvas>
            </div>
        </div>

        <div style="margin-top: 40px; border-top: 2px solid #333; padding-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
            <div><label>Client Signature(顾客签名):</label><div style="height:40px; border-bottom:1px solid #000;"></div></div>
            <div><label>YCM Acknowledgment(YCM签名):</label><div style="height:40px; border-bottom:1px solid #000;"></div></div>
        </div>
    </div>

    <script>
        // Generate Radio Buttons
        function createRadios(id, groupName) {
            const container = document.getElementById(id);
            let html = '';
            for(let i=1; i<=5; i++) {
                html += `
                    <label class="rating-label">
                        <input type="radio" name="${groupName}" value="${i}" onclick="updateCalc()">
                        ${i}
                    </label>
                `;
            }
            container.innerHTML = html;
        }

        // Initialize Radios
        const questions = [
            's1_q1', 's1_q2', 's1_q3',
            's2_q1', 's2_q2', 's2_q3',
            's3_q1', 's3_q2', 's3_q3'
        ];
        questions.forEach(q => createRadios(q, q));

        // Chart Initialization
        let radarChart;
        window.onload = function() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Service Quality', 'Interpreter', 'Workforce'],
                    datasets: [{
                        label: 'Client Score',
                        data: [0, 0, 0],
                        backgroundColor: 'rgba(0, 51, 102, 0.2)',
                        borderColor: 'rgba(0, 51, 102, 1)',
                        pointBackgroundColor: 'rgba(0, 51, 102, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { display: true },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        };

        // Calculation Logic
        function updateCalc() {
            // Helper to get score of a specific question group
            function getScore(name) {
                const els = document.getElementsByName(name);
                for (let i = 0; i < els.length; i++) {
                    if (els[i].checked) return parseInt(els[i].value);
                }
                return 0; // Default if not checked
            }

            // Calculate Averages
            // Section 1: Service
            let s1 = (getScore('s1_q1') + getScore('s1_q2') + getScore('s1_q3'));
            let s1_avg = s1 > 0 ? (s1 / 3).toFixed(1) : 0;
            document.getElementById('s1_avg').innerText = s1_avg;

            // Section 2: Interpreter
            let s2 = (getScore('s2_q1') + getScore('s2_q2') + getScore('s2_q3'));
            let s2_avg = s2 > 0 ? (s2 / 3).toFixed(1) : 0;
            document.getElementById('s2_avg').innerText = s2_avg;

            // Section 3: Worker
            let s3 = (getScore('s3_q1') + getScore('s3_q2') + getScore('s3_q3'));
            let s3_avg = s3 > 0 ? (s3 / 3).toFixed(1) : 0;
            document.getElementById('s3_avg').innerText = s3_avg;

            // Update Chart
            radarChart.data.datasets[0].data = [s1_avg, s2_avg, s3_avg];
            radarChart.update();
        }
    </script>
</body>
</html>
